<!DOCTYPE html>
<html lang="en">
  
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ClusterWS Chat</title>
</head>

<body>
    <input type="text" id="mymsg">
    <button id="sendmsg">Send Message</button>
    <p id="allmsg"></p>
  
    <!--  Import ClusterWS client Library     -->
    <script src="./ClusterWS.min.js"></script>
    <script>
        // Check https://github.com/goriunov/ClusterWS-Client-JS for more options  
        let clusterws = new ClusterWS({
            url: 'localhost',
            port: 80
        })
        
        // Listen on id event from the server and asign this id to this user
        let userId
        clusterws.on('id', (id) => userId = id)
        
        // Listen on connect event and then subscribe to the channel chat 
        // and in case of any messages on the channel, put it to the  'allmsg' bloc     
        let publicChat
        clusterws.on('connect', () => publicChat = clusterws.subscribe('chat').watch((msg) => document.getElementById('allmsg').innerHTML = document.getElementById('allmsg').innerHTML + '<br>' + msg))
        
        // Listen on click event on button Send Message and publish message which is written in input         
        document.getElementById('sendmsg').onclick = () => publicChat.publish('<strong>' + userId + ': </strong>' + document.getElementById('mymsg').value)
    </script>
</body>

</html>